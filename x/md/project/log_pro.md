### 日志位置
- 首先是服务启动阶段，我们需要打印系统的配置参数和数据库等组件初始化状态，以便确保系统是按照期望启动的。
- 其次是请求处理环节，我们需要记录参数、关键步骤的中间结果，除此之外，就像下面的代码，我们还需要在程序的分支逻辑中记录执行路径。这样当出现问题时，就能帮助我们快速进入特定分支流程排查，提高问题定位效率。
- 然后是外部交互部分，当我们与第三方服务进行通信时，记录发送和接收的数据日志十分必要。一旦出现问题，这些请求和返回日志不仅能帮助我们判断发出的请求以及下游给出的返回是否符合预期，还能帮助我们定位调用失败的原因。
- 接着是定期执行的后台任务，对于这类任务，记录它开始和结束时间以及任务运行过程的具体情况，有助于我们掌握后台任务的运行状态。
- 最后是异常处理环节，当服务运行出现偏离预期的情况时，我们必须及时打印错误详情日志，为后续的问题排查留存关键线索。
### 日志等级
除调试阶段会使用 DEBUG 日志外，线上环境我们一般记录下面三种级别的日志。
- 首先是 ERROR 级别，这是最高级别的日志，表示系统遇到了错误，导致部分功能无法正常执行，例如程序启动失败、接口调用超时等错误。这类错误通常需要立即关注和处理，以确保系统能够恢复到正常运行状态。
对于 ERROR 级别的日志，我们通常会设置告警机制，因此必须谨慎使用，避免滥用。如果错误地将所有问题都标记为 ERROR 级别，将会产生大量的告警噪音，这不仅会分散我们的注意力，还可能导致我们忽视那些真正重要的问题。
- 其次是 WARN 级别，这个级别的日志用于记录那些需要引起注意，但不会立即影响系统运行的问题。这些问题包括请求参数错误、非核心组件初始化失败、后端服务出现错误但最终重试成功等。
- 最后是 INFO 级别，这个级别的日志用来记录系统正常运行过程中的关键信息，包括程序的启动、关闭、配置变更等重要事件。
### 日志内容
除了时间、机器 IP、串联日志的请求 ID 这些通常由日志框架自动打印的标准字段之外，研发人员需要特别关注的是日志消息字段。一个优质的日志消息字段应该精确地记录足以反映当前事件的关键信息，主要包含下面这些内容。
- 首先是事件描述，清晰简洁地说明发生了什么事件，例如 “user login attempt”（用户尝试登录）。
 -接着是事件状态，用于表明事件处于何种状态，例如 “success（成功）”、“failed（失败）” “in progress（进行中）”等。
 - 然后是触发原因，对于 WARN 和 ERROR 级别的日志，我们应该明确导致这个事件状态异常的关键原因，例如 “due to invalid password”（由于密码错误）。
 - 之后是关键上下文信息，提供与事件紧密相关的信息，可以帮助我们更好的排查问题。例如在数据库操作相关日志中，记录操作的表名、SQL 语句。
 - 最后是函数调用堆栈信息，对于 ERROR 级别的日志，我们应该打印包含完整的函数调用堆栈信息，以便能准确确定错误发生的代码位置。
### 错误码设计
- 五位错误码
- 第一位：来源
- 中间两位：中间错误码
- 最后两位：具体错误码
