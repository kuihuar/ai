# è½¬æ¢å‡½æ•°é‡æ„æ€»ç»“

## é‡æ„å†…å®¹

æŒ‰ç…§æœ€ä½³å®è·µï¼Œå·²å°†è½¬æ¢å‡½æ•°ä» API å±‚ç§»åˆ°ç‹¬ç«‹çš„ Converter å±‚ã€‚

## é‡æ„å‰åå¯¹æ¯”

### é‡æ„å‰ï¼ˆä¸æ¨èï¼‰

**ä½ç½®**: `api/user/v1/user.go`

```go
// âŒ è½¬æ¢å‡½æ•°åœ¨APIå±‚
func ToUserInfo(user *entity.User) *UserInfo {
	// ...
}
```

**é—®é¢˜**:
- âŒ APIå±‚åº”è¯¥åªå®šä¹‰æ¥å£è§„èŒƒï¼Œä¸åº”è¯¥åŒ…å«ä¸šåŠ¡é€»è¾‘
- âŒ è¿åäº†åˆ†å±‚æ¶æ„åŸåˆ™
- âŒ APIå±‚ä¸åº”è¯¥ä¾èµ–Entityï¼ˆè™½ç„¶æŠ€æœ¯ä¸Šå¯ä»¥ï¼‰

### é‡æ„åï¼ˆæ¨èï¼‰

**ä½ç½®**: `internal/converter/user.go`

```go
// âœ… è½¬æ¢å‡½æ•°åœ¨ç‹¬ç«‹çš„Converterå±‚
package converter

func ToUserInfo(user *entity.User) *v1.UserInfo {
	// ...
}
```

**ä¼˜åŠ¿**:
- âœ… èŒè´£å•ä¸€ï¼Œä¸“é—¨è´Ÿè´£è½¬æ¢
- âœ… å¯è¢«å¤šä¸ªControllerå¤ç”¨
- âœ… æ˜“äºæµ‹è¯•å’Œç»´æŠ¤
- âœ… ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™
- âœ… APIå±‚ä¿æŒçº¯å‡€ï¼Œåªå®šä¹‰æ¥å£è§„èŒƒ

## æ–°çš„ç›®å½•ç»“æ„

```
internal/
  â”œâ”€â”€ converter/          â† æ–°å¢ï¼šè½¬æ¢å±‚
  â”‚   â””â”€â”€ user.go         â† è½¬æ¢å‡½æ•°
  â”œâ”€â”€ controller/
  â”‚   â””â”€â”€ user/
  â”œâ”€â”€ service/
  â”œâ”€â”€ logic/
  â”œâ”€â”€ dao/
  â””â”€â”€ model/
```

## ä¿®æ”¹çš„æ–‡ä»¶

### 1. æ–°å¢æ–‡ä»¶

- âœ… `internal/converter/user.go` - è½¬æ¢å‡½æ•°

### 2. ä¿®æ”¹æ–‡ä»¶

- âœ… `api/user/v1/user.go` - ç§»é™¤è½¬æ¢å‡½æ•°ï¼Œç§»é™¤entityå¯¼å…¥
- âœ… `internal/controller/user/user_v1_get_by_id.go` - ä½¿ç”¨converteråŒ…
- âœ… `internal/controller/user/user_v1_get_list.go` - ä½¿ç”¨converteråŒ…

## ä»£ç å¯¹æ¯”

### APIå±‚ï¼ˆé‡æ„åï¼‰

```go
// api/user/v1/user.go
package v1

import (
	"github.com/gogf/gf/v2/frame/g"
)

// UserInfo APIç”¨æˆ·ä¿¡æ¯ï¼ˆç‹¬ç«‹å®šä¹‰ï¼‰
type UserInfo struct {
	Id        uint   `json:"id"        dc:"ç”¨æˆ·ID"`
	Name      string `json:"name"      dc:"ç”¨æˆ·å"`
	Email     string `json:"email"     dc:"é‚®ç®±"`
	Phone     string `json:"phone"     dc:"æ‰‹æœºå·"`
	CreatedAt string `json:"createdAt" dc:"åˆ›å»ºæ—¶é—´"`
	UpdatedAt string `json:"updatedAt" dc:"æ›´æ–°æ—¶é—´"`
}

// GetByIdRes æ ¹æ®IDè·å–ç”¨æˆ·å“åº”
type GetByIdRes struct {
	*UserInfo
}

// GetListRes è·å–ç”¨æˆ·åˆ—è¡¨å“åº”
type GetListRes struct {
	List  []*UserInfo `json:"list"  dc:"ç”¨æˆ·åˆ—è¡¨"`
	Total int         `json:"total" dc:"æ€»æ•°"`
	Page  int         `json:"page"  dc:"å½“å‰é¡µç "`
	Size  int         `json:"size"  dc:"æ¯é¡µæ•°é‡"`
}
```

**ç‰¹ç‚¹**: 
- âœ… åªå®šä¹‰æ¥å£è§„èŒƒ
- âœ… ä¸åŒ…å«ä¸šåŠ¡é€»è¾‘
- âœ… ä¸ä¾èµ–Entity

### Converterå±‚ï¼ˆæ–°å¢ï¼‰

```go
// internal/converter/user.go
package converter

import (
	"hz/api/user/v1"
	"hz/internal/model/entity"
)

// ToUserInfo å°†Entityè½¬æ¢ä¸ºAPIå“åº”ç»“æ„
func ToUserInfo(user *entity.User) *v1.UserInfo {
	if user == nil {
		return nil
	}
	return &v1.UserInfo{
		Id:        user.Id,
		Name:      user.Name,
		Email:     user.Email,
		Phone:     user.Phone,
		CreatedAt: user.CreatedAt,
		UpdatedAt: user.UpdatedAt,
	}
}

// ToUserInfoList æ‰¹é‡è½¬æ¢
func ToUserInfoList(users []*entity.User) []*v1.UserInfo {
	if users == nil {
		return nil
	}
	result := make([]*v1.UserInfo, 0, len(users))
	for _, user := range users {
		result = append(result, ToUserInfo(user))
	}
	return result
}
```

**ç‰¹ç‚¹**:
- âœ… ä¸“é—¨è´Ÿè´£æ•°æ®è½¬æ¢
- âœ… å¯è¢«å¤šä¸ªControllerå¤ç”¨
- âœ… æ˜“äºæµ‹è¯•å’Œç»´æŠ¤

### Controllerå±‚ï¼ˆæ›´æ–°ï¼‰

```go
// internal/controller/user/user_v1_get_by_id.go
package user

import (
	"context"
	v1 "hz/api/user/v1"
	"hz/internal/converter"  // å¯¼å…¥converteråŒ…
	"hz/internal/service"
)

func (c *ControllerV1) GetById(ctx context.Context, req *v1.GetByIdReq) (res *v1.GetByIdRes, err error) {
	user, err := service.UserEnhanced.GetById(ctx, req.Id)
	if err != nil {
		return nil, err
	}
	
	// ä½¿ç”¨converteråŒ…è¿›è¡Œè½¬æ¢
	return &v1.GetByIdRes{
		UserInfo: converter.ToUserInfo(user),
	}, nil
}
```

## æ¶æ„å±‚æ¬¡æ›´æ–°

### æ–°çš„å±‚æ¬¡ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         API Layer (api/)                â”‚  æ¥å£å®šä¹‰å±‚
â”‚  - å®šä¹‰è¯·æ±‚/å“åº”ç»“æ„ä½“                   â”‚
â”‚  - å®šä¹‰è·¯ç”±å…ƒä¿¡æ¯                        â”‚
â”‚  - âŒ ä¸åŒ…å«è½¬æ¢é€»è¾‘                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Controller Layer (controller/)     â”‚  æ§åˆ¶å™¨å±‚
â”‚  - å¤„ç†HTTPè¯·æ±‚                          â”‚
â”‚  - è°ƒç”¨Converterè¿›è¡Œè½¬æ¢                 â”‚
â”‚  - è°ƒç”¨Serviceå±‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Converter      â”‚  â”‚   Service       â”‚
â”‚  (converter/)   â”‚  â”‚   (service/)    â”‚
â”‚  - æ•°æ®è½¬æ¢     â”‚  â”‚   - ä¸šåŠ¡ç¼–æ’    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä¼˜åŠ¿æ€»ç»“

### 1. èŒè´£åˆ†ç¦»

- âœ… **APIå±‚**: åªå®šä¹‰æ¥å£è§„èŒƒ
- âœ… **Converterå±‚**: ä¸“é—¨è´Ÿè´£æ•°æ®è½¬æ¢
- âœ… **Controllerå±‚**: å¤„ç†HTTPè¯·æ±‚å’Œè°ƒç”¨è½¬æ¢

### 2. å¯å¤ç”¨æ€§

- âœ… Converterå¯è¢«å¤šä¸ªControllerä½¿ç”¨
- âœ… è½¬æ¢é€»è¾‘é›†ä¸­ç®¡ç†
- âœ… æ˜“äºç»´æŠ¤å’Œæ‰©å±•

### 3. æ˜“äºæµ‹è¯•

- âœ… Converterå¯ä»¥ç‹¬ç«‹æµ‹è¯•
- âœ… ä¸ä¾èµ–HTTPæ¡†æ¶
- âœ… æµ‹è¯•ç®€å•ç›´æ¥

### 4. ç¬¦åˆæ¶æ„åŸåˆ™

- âœ… å•ä¸€èŒè´£åŸåˆ™
- âœ… åˆ†å±‚æ¶æ„åŸåˆ™
- âœ… ä¾èµ–å€’ç½®åŸåˆ™

## ä½¿ç”¨ç¤ºä¾‹

### Controllerä½¿ç”¨Converter

```go
// å•ä¸ªè½¬æ¢
userInfo := converter.ToUserInfo(user)

// æ‰¹é‡è½¬æ¢
userInfoList := converter.ToUserInfoList(users)
```

### æ‰©å±•Converter

å¦‚æœå°†æ¥éœ€è¦æ”¯æŒå…¶ä»–è½¬æ¢ï¼š

```go
// internal/converter/user.go

// ToUserInfoV2 è½¬æ¢ä¸ºv2ç‰ˆæœ¬çš„å“åº”ç»“æ„
func ToUserInfoV2(user *entity.User) *v2.UserInfo {
	// ...
}

// ToUserSummary è½¬æ¢ä¸ºæ‘˜è¦ä¿¡æ¯
func ToUserSummary(user *entity.User) *v1.UserSummary {
	// ...
}
```

## æ€»ç»“

### âœ… å·²å®Œæˆçš„é‡æ„

1. **åˆ›å»ºConverterå±‚** - `internal/converter/user.go`
2. **ç§»é™¤APIå±‚çš„è½¬æ¢å‡½æ•°** - ä¿æŒAPIå±‚çº¯å‡€
3. **æ›´æ–°Controllerå±‚** - ä½¿ç”¨converteråŒ…
4. **ä»£ç éªŒè¯** - æ‰€æœ‰ä»£ç é€šè¿‡lintæ£€æŸ¥

### âœ… é‡æ„å¸¦æ¥çš„ä¼˜åŠ¿

1. **èŒè´£æ¸…æ™°** - æ¯å±‚èŒè´£å•ä¸€
2. **å¯å¤ç”¨æ€§** - Converterå¯è¢«å¤šä¸ªåœ°æ–¹ä½¿ç”¨
3. **æ˜“äºç»´æŠ¤** - è½¬æ¢é€»è¾‘é›†ä¸­ç®¡ç†
4. **ç¬¦åˆæ¶æ„** - éµå¾ªåˆ†å±‚æ¶æ„åŸåˆ™

### ğŸ“ å…³é”®åŸåˆ™

- âœ… **APIå±‚** â†’ åªå®šä¹‰æ¥å£è§„èŒƒ
- âœ… **Converterå±‚** â†’ ä¸“é—¨è´Ÿè´£æ•°æ®è½¬æ¢
- âœ… **Controllerå±‚** â†’ å¤„ç†HTTPè¯·æ±‚å’Œè°ƒç”¨è½¬æ¢

**æ‰€æœ‰é‡æ„å·²å®Œæˆï¼Œä»£ç ç¬¦åˆæœ€ä½³å®è·µï¼**

