# æ„å»ºå·¥å…·ä¸å®¹å™¨åŒ–

## ğŸ“š å­¦ä¹ ç›®æ ‡

é€šè¿‡æœ¬æ¨¡å—å­¦ä¹ ï¼Œæ‚¨å°†æŒæ¡ï¼š
- ç°ä»£æ„å»ºå·¥å…·çš„ä½¿ç”¨å’Œæœ€ä½³å®è·µ
- å®¹å™¨åŒ–æ„å»ºæµç¨‹å’Œä¼˜åŒ–ç­–ç•¥
- å¤šé˜¶æ®µæ„å»ºå’Œæ„å»ºç¼“å­˜ä¼˜åŒ–
- æ„å»ºå®‰å…¨æ‰«æå’Œæ¼æ´ç®¡ç†
- æ„å»ºæµæ°´çº¿é›†æˆå’Œè‡ªåŠ¨åŒ–

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

### 1. æ„å»ºå·¥å…·ç”Ÿæ€

ç°ä»£åº”ç”¨æ„å»ºæ¶‰åŠå¤šä¸ªå±‚é¢çš„å·¥å…·ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                åº”ç”¨æ„å»ºå·¥å…·                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ è¯­è¨€æ„å»ºå·¥å…· â”‚ â”‚ åŒ…ç®¡ç†å·¥å…·   â”‚ â”‚ æµ‹è¯•å·¥å…· â”‚   â”‚
â”‚  â”‚ Maven/Gradleâ”‚ â”‚ npm/yarn    â”‚ â”‚ JUnit   â”‚   â”‚
â”‚  â”‚ npm/yarn    â”‚ â”‚ pip/poetry  â”‚ â”‚ Jest    â”‚   â”‚
â”‚  â”‚ pip/poetry  â”‚ â”‚ go mod      â”‚ â”‚ pytest  â”‚   â”‚
â”‚  â”‚ go build    â”‚ â”‚ cargo       â”‚ â”‚ go test â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ å®¹å™¨æ„å»ºå·¥å…· â”‚ â”‚ é•œåƒä¼˜åŒ–å·¥å…· â”‚ â”‚ å®‰å…¨å·¥å…· â”‚   â”‚
â”‚  â”‚ Docker      â”‚ â”‚ BuildKit    â”‚ â”‚ Trivy   â”‚   â”‚
â”‚  â”‚ Buildah     â”‚ â”‚ Dive        â”‚ â”‚ Snyk    â”‚   â”‚
â”‚  â”‚ Podman      â”‚ â”‚ Distroless  â”‚ â”‚ Clair   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ CI/CDå·¥å…·    â”‚ â”‚ åŒ…ç®¡ç†å·¥å…·   â”‚ â”‚ ç›‘æ§å·¥å…· â”‚   â”‚
â”‚  â”‚ Jenkins     â”‚ â”‚ Helm        â”‚ â”‚ Prometheusâ”‚   â”‚
â”‚  â”‚ GitLab CI   â”‚ â”‚ Kustomize   â”‚ â”‚ Grafana  â”‚   â”‚
â”‚  â”‚ GitHub Actionsâ”‚ â”‚ Operator   â”‚ â”‚ ELK Stackâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. æ„å»ºæµç¨‹æ¼”è¿›

```
ä¼ ç»Ÿæ„å»º                   ç°ä»£æ„å»º
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœ¬åœ°ç¼–è¯‘    â”‚            â”‚ å®¹å™¨åŒ–æ„å»º      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ‰‹åŠ¨æ‰“åŒ…    â”‚            â”‚ å¤šé˜¶æ®µæ„å»º      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ‰‹åŠ¨éƒ¨ç½²    â”‚            â”‚ è‡ªåŠ¨åŒ–æµæ°´çº¿    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¯å¢ƒå·®å¼‚    â”‚            â”‚ ç¯å¢ƒä¸€è‡´æ€§      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é…ç½®å¤æ‚    â”‚            â”‚ å£°æ˜å¼é…ç½®      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ è¯­è¨€æ„å»ºå·¥å…·

### 1. Java æ„å»ºå·¥å…·

#### Maven
```xml
<!-- pom.xml -->
<project>
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.example</groupId>
    <artifactId>myapp</artifactId>
    <version>1.0.0</version>
    <packaging>jar</packaging>

    <properties>
        <maven.compiler.source>11</maven.compiler.source>
        <maven.compiler.target>11</maven.compiler.target>
        <spring.boot.version>2.7.0</spring.boot.version>
    </properties>

    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
            <version>${spring.boot.version}</version>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <version>${spring.boot.version}</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>repackage</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project>
```

#### Gradle
```gradle
// build.gradle
plugins {
    id 'org.springframework.boot' version '2.7.0'
    id 'io.spring.dependency-management' version '1.0.11.RELEASE'
    id 'java'
}

group = 'com.example'
version = '1.0.0'
sourceCompatibility = '11'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

tasks.named('test') {
    useJUnitPlatform()
}
```

### 2. Node.js æ„å»ºå·¥å…·

#### npm/yarn
```json
// package.json
{
  "name": "myapp",
  "version": "1.0.0",
  "scripts": {
    "build": "next build",
    "start": "next start",
    "dev": "next dev",
    "test": "jest",
    "lint": "eslint .",
    "type-check": "tsc --noEmit"
  },
  "dependencies": {
    "next": "12.3.0",
    "react": "18.2.0",
    "react-dom": "18.2.0"
  },
  "devDependencies": {
    "@types/react": "18.0.0",
    "@types/node": "18.0.0",
    "typescript": "4.8.0",
    "jest": "28.0.0",
    "eslint": "8.0.0"
  }
}
```

#### æ„å»ºè„šæœ¬
```bash
#!/bin/bash
# build.sh

set -e

echo "Installing dependencies..."
npm ci

echo "Running type check..."
npm run type-check

echo "Running linting..."
npm run lint

echo "Running tests..."
npm run test

echo "Building application..."
npm run build

echo "Build completed successfully!"
```

### 3. Python æ„å»ºå·¥å…·

#### Poetry
```toml
# pyproject.toml
[tool.poetry]
name = "myapp"
version = "1.0.0"
description = "My Python Application"
authors = ["Your Name <your.email@example.com>"]

[tool.poetry.dependencies]
python = "^3.9"
fastapi = "^0.68.0"
uvicorn = "^0.15.0"

[tool.poetry.group.dev.dependencies]
pytest = "^6.2.0"
black = "^21.0.0"
flake8 = "^3.9.0"

[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"

[tool.poetry.scripts]
myapp = "myapp.main:main"
```

#### æ„å»ºè„šæœ¬
```bash
#!/bin/bash
# build.sh

set -e

echo "Installing dependencies..."
poetry install

echo "Running linting..."
poetry run black --check .
poetry run flake8 .

echo "Running tests..."
poetry run pytest

echo "Building package..."
poetry build

echo "Build completed successfully!"
```

### 4. Go æ„å»ºå·¥å…·

#### Go Modules
```go
// go.mod
module github.com/example/myapp

go 1.19

require (
    github.com/gin-gonic/gin v1.9.0
    github.com/stretchr/testify v1.8.2
)

require (
    github.com/davecgh/go-spew v1.1.1 // indirect
    github.com/pmezard/go-difflib v1.0.0 // indirect
    gopkg.in/yaml.v3 v3.0.1 // indirect
)
```

#### æ„å»ºè„šæœ¬
```bash
#!/bin/bash
# build.sh

set -e

echo "Installing dependencies..."
go mod download
go mod verify

echo "Running tests..."
go test -v ./...

echo "Running linting..."
golangci-lint run

echo "Building application..."
CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o main .

echo "Build completed successfully!"
```

## ğŸ³ å®¹å™¨åŒ–æ„å»º

### 1. Docker å¤šé˜¶æ®µæ„å»º

#### åŸºç¡€å¤šé˜¶æ®µæ„å»º
```dockerfile
# æ„å»ºé˜¶æ®µ
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

# ç”Ÿäº§é˜¶æ®µ
FROM node:18-alpine AS production
WORKDIR /app
COPY --from=builder /app/node_modules ./node_modules
COPY . .
USER node
EXPOSE 3000
CMD ["npm", "start"]
```

#### é«˜çº§å¤šé˜¶æ®µæ„å»º
```dockerfile
# ä¾èµ–é˜¶æ®µ
FROM node:18-alpine AS deps
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production && npm cache clean --force

# æ„å»ºé˜¶æ®µ
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

# æµ‹è¯•é˜¶æ®µ
FROM node:18-alpine AS tester
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run test

# ç”Ÿäº§é˜¶æ®µ
FROM node:18-alpine AS runner
WORKDIR /app

ENV NODE_ENV=production

RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

COPY --from=deps /app/node_modules ./node_modules
COPY --from=builder /app/dist ./dist
COPY --from=builder /app/package*.json ./

USER nextjs
EXPOSE 3000
CMD ["npm", "start"]
```

### 2. BuildKit é«˜çº§ç‰¹æ€§

#### å¯ç”¨ BuildKit
```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export DOCKER_BUILDKIT=1

# æˆ–ä½¿ç”¨ buildx
docker buildx build --platform linux/amd64,linux/arm64 -t myapp:latest .
```

#### æ„å»ºç¼“å­˜ä¼˜åŒ–
```dockerfile
# syntax=docker/dockerfile:1
FROM node:18-alpine

# ä½¿ç”¨æ„å»ºç¼“å­˜
RUN --mount=type=cache,target=/root/.npm \
    npm install

# å¹¶è¡Œæ„å»º
RUN --mount=type=cache,target=/root/.npm \
    --mount=type=bind,source=package.json,target=package.json \
    npm ci
```

#### å¤šå¹³å°æ„å»º
```dockerfile
# syntax=docker/dockerfile:1
FROM --platform=$BUILDPLATFORM node:18-alpine AS builder
ARG TARGETPLATFORM
ARG BUILDPLATFORM
RUN echo "I am running on $BUILDPLATFORM, building for $TARGETPLATFORM"

FROM node:18-alpine
COPY --from=builder /app /app
```

### 3. æ„å»ºä¼˜åŒ–ç­–ç•¥

#### é•œåƒå¤§å°ä¼˜åŒ–
```dockerfile
# ä½¿ç”¨ distroless åŸºç¡€é•œåƒ
FROM gcr.io/distroless/nodejs18-debian11

# ä½¿ç”¨ Alpine åŸºç¡€é•œåƒ
FROM node:18-alpine

# å¤šé˜¶æ®µæ„å»ºå‡å°‘å±‚æ•°
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci && npm run build

FROM node:18-alpine
WORKDIR /app
COPY --from=builder /app/dist ./dist
COPY --from=builder /app/node_modules ./node_modules
```

#### æ„å»ºé€Ÿåº¦ä¼˜åŒ–
```dockerfile
# åˆ©ç”¨ Docker å±‚ç¼“å­˜
FROM node:18-alpine
WORKDIR /app

# å…ˆå¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY package*.json ./
RUN npm ci

# å†å¤åˆ¶æºä»£ç 
COPY . .
RUN npm run build
```

## ğŸ”’ æ„å»ºå®‰å…¨

### 1. å®‰å…¨æ‰«æå·¥å…·

#### Trivy æ‰«æ
```bash
# å®‰è£… Trivy
curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sh

# æ‰«æé•œåƒ
trivy image nginx:latest

# æ‰«ææ–‡ä»¶ç³»ç»Ÿ
trivy fs .

# æ‰«æé…ç½®æ–‡ä»¶
trivy config .
```

#### Snyk æ‰«æ
```bash
# å®‰è£… Snyk
npm install -g snyk

# æ‰«æé¡¹ç›®
snyk test

# æ‰«æå®¹å™¨é•œåƒ
snyk container test nginx:latest

# ç›‘æ§é¡¹ç›®
snyk monitor
```

### 2. å®‰å…¨æ„å»ºå®è·µ

#### é root ç”¨æˆ·
```dockerfile
FROM node:18-alpine

# åˆ›å»ºé root ç”¨æˆ·
RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

# åˆ‡æ¢åˆ°é root ç”¨æˆ·
USER nextjs

# è®¾ç½®å·¥ä½œç›®å½•æƒé™
WORKDIR /app
RUN chown nextjs:nodejs /app
```

#### æœ€å°æƒé™åŸåˆ™
```dockerfile
FROM node:18-alpine

# åªå®‰è£…å¿…è¦çš„åŒ…
RUN apk add --no-cache \
    dumb-init \
    && rm -rf /var/cache/apk/*

# ä½¿ç”¨éç‰¹æƒç«¯å£
EXPOSE 3000

# åªè¯»æ–‡ä»¶ç³»ç»Ÿ
RUN mkdir -p /app/tmp
VOLUME ["/app/tmp"]
```

## ğŸš€ CI/CD é›†æˆ

### 1. GitHub Actions

#### æ„å»ºæµæ°´çº¿
```yaml
# .github/workflows/build.yml
name: Build and Deploy

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

env:
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      packages: write

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v2

    - name: Log in to Container Registry
      uses: docker/login-action@v2
      with:
        registry: ${{ env.REGISTRY }}
        username: ${{ github.actor }}
        password: ${{ secrets.GITHUB_TOKEN }}

    - name: Extract metadata
      id: meta
      uses: docker/metadata-action@v4
      with:
        images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}
        tags: |
          type=ref,event=branch
          type=ref,event=pr
          type=semver,pattern={{version}}
          type=sha

    - name: Build and push Docker image
      uses: docker/build-push-action@v4
      with:
        context: .
        push: true
        tags: ${{ steps.meta.outputs.tags }}
        labels: ${{ steps.meta.outputs.labels }}
        cache-from: type=gha
        cache-to: type=gha,mode=max

    - name: Run Trivy vulnerability scanner
      uses: aquasecurity/trivy-action@master
      with:
        image-ref: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:${{ github.sha }}
        format: 'sarif'
        output: 'trivy-results.sarif'

    - name: Upload Trivy scan results
      uses: github/codeql-action/upload-sarif@v2
      with:
        sarif_file: 'trivy-results.sarif'
```

### 2. GitLab CI

#### æ„å»ºæµæ°´çº¿
```yaml
# .gitlab-ci.yml
stages:
  - build
  - test
  - security
  - deploy

variables:
  DOCKER_DRIVER: overlay2
  DOCKER_TLS_CERTDIR: "/certs"

build:
  stage: build
  image: docker:20.10.16
  services:
    - docker:20.10.16-dind
  before_script:
    - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY
  script:
    - docker build -t $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA .
    - docker push $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA
  only:
    - main
    - develop

test:
  stage: test
  image: node:18-alpine
  script:
    - npm ci
    - npm run test
    - npm run lint
  coverage: '/Lines\s*:\s*(\d+\.\d+)%/'
  artifacts:
    reports:
      coverage_report:
        coverage_format: cobertura
        path: coverage/cobertura-coverage.xml

security:
  stage: security
  image: aquasec/trivy:latest
  script:
    - trivy image --exit-code 0 --no-progress $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA
  allow_failure: true
```

### 3. Jenkins Pipeline

#### æ„å»ºæµæ°´çº¿
```groovy
// Jenkinsfile
pipeline {
    agent any
    
    environment {
        DOCKER_IMAGE = 'myapp'
        DOCKER_TAG = "${env.BUILD_NUMBER}"
        REGISTRY = 'registry.example.com'
    }
    
    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }
        
        stage('Build') {
            steps {
                sh 'npm ci'
                sh 'npm run build'
            }
        }
        
        stage('Test') {
            steps {
                sh 'npm run test'
                sh 'npm run lint'
            }
            post {
                always {
                    junit 'test-results.xml'
                }
            }
        }
        
        stage('Security Scan') {
            steps {
                sh 'trivy image --exit-code 0 --no-progress ${REGISTRY}/${DOCKER_IMAGE}:${DOCKER_TAG}'
            }
        }
        
        stage('Build Docker Image') {
            steps {
                script {
                    docker.build("${REGISTRY}/${DOCKER_IMAGE}:${DOCKER_TAG}")
                }
            }
        }
        
        stage('Push Docker Image') {
            steps {
                script {
                    docker.withRegistry("https://${REGISTRY}", 'registry-credentials') {
                        docker.image("${REGISTRY}/${DOCKER_IMAGE}:${DOCKER_TAG}").push()
                    }
                }
            }
        }
    }
    
    post {
        always {
            cleanWs()
        }
        success {
            echo 'Pipeline succeeded!'
        }
        failure {
            echo 'Pipeline failed!'
        }
    }
}
```

## ğŸ› ï¸ å®è·µç»ƒä¹ 

### ç»ƒä¹ 1: å¤šè¯­è¨€åº”ç”¨æ„å»º

```dockerfile
# å‰ç«¯æ„å»º
FROM node:18-alpine AS frontend
WORKDIR /app/frontend
COPY frontend/package*.json ./
RUN npm ci
COPY frontend/ .
RUN npm run build

# åç«¯æ„å»º
FROM golang:1.19-alpine AS backend
WORKDIR /app/backend
COPY backend/go.mod backend/go.sum ./
RUN go mod download
COPY backend/ .
RUN CGO_ENABLED=0 GOOS=linux go build -o main .

# æœ€ç»ˆé•œåƒ
FROM alpine:latest
RUN apk --no-cache add ca-certificates
WORKDIR /root/
COPY --from=backend /app/backend/main .
COPY --from=frontend /app/frontend/dist ./static
CMD ["./main"]
```

### ç»ƒä¹ 2: æ„å»ºä¼˜åŒ–

```dockerfile
# ä½¿ç”¨ BuildKit ç¼“å­˜
# syntax=docker/dockerfile:1
FROM node:18-alpine

# ç¼“å­˜ä¾èµ–å®‰è£…
RUN --mount=type=cache,target=/root/.npm \
    npm install

# å¹¶è¡Œæ„å»º
RUN --mount=type=cache,target=/root/.npm \
    --mount=type=bind,source=package.json,target=package.json \
    npm ci
```

## ğŸ“š ç›¸å…³èµ„æº

### å®˜æ–¹æ–‡æ¡£
- [Docker å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)
- [BuildKit æ–‡æ¡£](https://docs.docker.com/build/buildkit/)
- [Trivy æ–‡æ¡£](https://aquasecurity.github.io/trivy/)

### å­¦ä¹ èµ„æº
- [Docker æœ€ä½³å®è·µ](https://docs.docker.com/develop/dev-best-practices/)
- [å®¹å™¨å®‰å…¨æŒ‡å—](https://kubernetes.io/docs/concepts/security/)

### å·¥å…·æ¨è
- **Docker**: å®¹å™¨åŒ–å¹³å°
- **BuildKit**: é«˜çº§æ„å»ºç‰¹æ€§
- **Trivy**: å®‰å…¨æ‰«æå·¥å…·
- **Dive**: é•œåƒåˆ†æå·¥å…·
- **Snyk**: æ¼æ´ç®¡ç†å¹³å°

---

**æŒæ¡ç°ä»£æ„å»ºå·¥å…·ï¼Œå®ç°é«˜æ•ˆå®¹å™¨åŒ–éƒ¨ç½²ï¼** ğŸš€
